pipeline {

agent any

stages {

stage('Build and Push Image'){
steps {
 script{
   docker.withRegistry('https://registry.hub.docker.com', 'docker_hub') {

        def customImage = docker.build("pmayukh/webapp:${env.BUILD_NUMBER}")

        /* Push the container to the custom Registry */
        customImage.push()
    }
    }
   }
  }   
 }
}
        
/* environment {

registry = "pmayukh/PG_devops_project"
registryCredential = docker_hub
dockerImage = ''

}

tools{
maven "mymaven"
jdk "myjava"
}

agent any

stages{

stage('Checkout code'){
 steps{
 git url:" https://github.com/PMayukh/PG_Devops_Project.git", branch:"master"
}
}

stage('Building image'){
 steps{
  script{
    dockerImage=docker.build registry + :"${BUILD_NUMBER}"
  }
 }
}

stage('Deploy image'){
 steps{
   docker.withRegistry('registry.hub.docker.com', registryCredential)
   dockerImage.push()
 }
}

}
}
*/ 
